name: Update from Infohub

on:
  repository_dispatch:
    types: [infohub-content-update]

jobs:
  test-access:
    runs-on: ubuntu-latest
    steps:
      - name: Test access to infohub
        run: |
          curl -H "Authorization: token ${{ secrets.INFOHUB_TOKEN }}" \
               https://api.github.com/repos/cdkooistra/infohub
  update-readme:
    uses: cdkooistra/infohub/.github/workflows/processor.yml@main
    with:
      apply_script: |
        cp "$CONTENT/content/profile-readme.md" README.md
        echo "Updated README.md from infohub"
    secrets:
      INFOHUB_TOKEN: ${{ secrets.INFOHUB_TOKEN }}
